# 简易仿真

## 数据收集、存储与读取

[常规串口读取](https://blog.csdn.net/gjh13/article/details/80409538)

[针对arduino](https://blog.csdn.net/qq_32896521/article/details/123354220?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-1-123354220-blog-80409538.pc_relevant_default&spm=1001.2101.3001.4242.2&utm_relevant_index=3)

下载使用serial库，

初始化串口类后，使用readline()函数读取一行的数据，再编码器中就是读取整一行（6个角度）的数据，将其转成string类型后，使用re库对读取的编码进行正则化处理，得到数字（这里有点没看懂，后面有需要再用到的时候再查）





## 根据数据实时绘制图像

计划使用python自带的Robotics Toolbox

主要教程：[介绍文档 ](https://petercorke.github.io/robotics-toolbox-python/intro.html) [git源码](https://github.com/petercorke/robotics-toolbox-python)  [pycapacity ](https://auctus-team.gitlabpages.inria.fr/people/antunskuric/pycapacity/index.html) [介绍文档-2](https://pypi.org/project/roboticstoolbox-python/#3)

[实战教程](https://github.com/jhavl/dkt)



4.3 完成在python中完成给定角度绘制图像功能，但是并不是实时的



## GUI搭建

目前决定使用tkinter包作为搭建gui的工具，具体的教程如下[知乎教程](https://zhuanlan.zhihu.com/p/75872830)、[菜鸟教程](runoob.com/python/python-gui-tkinter.html#:~:text=Python%20GUI编程%20%28Tkinter%29%201%20Tkinter：%20Tkinter%20模块%20%28Tk,Java%20的模块。%20Jython%20几乎拥有标准的Python%20中不依赖于%20C%20语言的全部模块。%20)

目前tkinter似乎只能做到简单的静态图像绘制，这里是[Qt](https://www.pythonguis.com/tutorials/plotting-matplotlib/)

TK类，使用tk之前需要实例化一个类 name = TK()

之后就可以使用这个类的各种函数了，以下是各种API的笔记

**title**：在左上角出现一个标题

**Lable:** 一种类，类似于title，title出现在窗口以外，label出现在里面，而且必须要实例化后再调用grid 函数，实例化时可以设置字体类型大小等一系列参数；

```python
from tkinter import *

window = Tk()
window.title("First Window")
lbl = Label(window, text="Hello")
lbl.grid(column=0, row=0)
window.mainloop()
```

Button： 和Leble一样也是一个类，因此使用前需要实例化，





## pyQt

[a demo](https://blog.csdn.net/MacwinWin/article/details/86236576)





## 转战pybullet

目前的方案是使用while函数，每一次更新输入编码器数据时借用rbtoolbox绘制一次图像，这样可行，但是图像是一帧一帧的不够流畅，不知道仿真库是如何做到流畅的，与其去学习仿真库的源代码（看了一下好像没有），不如直接用pybullet直接实时仿真

接下来要做的任务：

* 复习，深入学习pybullet
* 编写master+slave urdf文件
* 编写仿真代码



### 编写urdf文件

目前正在使用sw直接生成urdf文件[例程1](https://blog.csdn.net/weixin_45168199/article/details/105755388)[例程2](https://zhuanlan.zhihu.com/p/400444421)

需要注意以下问题：

* 文件得放在pybullet_data里面，我也不知道为啥
* sw导出urdf的时候一定不能多次使用同一个文件
* 对于revolution和prismatic类型的关节，导出urdf之后需要设置转动范围，要不然默认(0,0)



目前读取不了导出的urdf，怀疑是没有打出mesh，通过调试验证的确是mesh的问题，但是现在测试的二连杆在仿真里面是这样的

4-6：完成简易对象（小车和风扇）的urdf导出，尝试导出操纵器urdf

晚上完成了主端手术机器urdf模型的导出，通过仿真验证了可行性



### 编写控制程序

1. 创建masterRobot的类，我们就是最简单的位置控制就行了
2. 编写一个函数，输入是编码器的角度

目前问题是没反应，下午debug，完成debug，也可以读取之间录制的角度，目前没有什么问题

之后再将仿真与单片机读取的数据实时结合目标就算完成了

之后再把执行端连续体的模型urdf搞一搞



4-20：完成执行端连续体urdf模型，其实还差一点，根部伸缩运动忘记加了，之后把他加上

完成同一个文件内导入两个对象，现在将主从端之间的运动联系起来



